version: 2

sources:
  - name: {{ relation.schema.lower() }}
{%- if source_database %}
    database: {{ source_database }}
{%- endif %}
    schema: {{ relation.schema.lower() }}
    tables:
      - name: {{ relation.name.lower() }}
        identifier: {{ relation.name }}

models:
  - name: {{ model.lower() }}
    columns:
{%- for cols in nested.values() %}
      - name: {{ cols["key"].lower().replace(" ","_").replace(":","_").replace("(","_").replace(")","_") }}
      - description: {{ cols["description"].lower().replace(" ","_").replace(":","_").replace("(","_").replace(")","_") }}
{%- endfor %}
{%- for col in columns %}
      - name: {{ col.name.lower() }}
{%- endfor %}